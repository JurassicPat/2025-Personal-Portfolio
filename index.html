<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="The official Portfolio Website for Patrick Watertor the Designer and Developer."
    />
    <title>Patrick Watertor | Portfolio Website</title>

    <!-- CookieConsent CSS (self-hosted) -->
    <link
      rel="preload"
      as="style"
      href="/libs/cookieconsent/cookieconsent.min.css"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript>
      <link rel="stylesheet" href="/libs/cookieconsent/cookieconsent.min.css" />
    </noscript>

    <!-- Critical CSS -->
    <link rel="stylesheet" href="/src/styles/critical.css" />

    <!-- Non-critical CSS -->
    <link
      rel="preload"
      href="/src/styles/NonCritical.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript>
      <link rel="stylesheet" href="/src/styles/NonCritical.css" />
    </noscript>

    <!-- Preload fonts -->
    <link
      rel="preload"
      href="/assets/fonts/outfit-latin-300-normal.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/fonts/outfit-latin-500-normal.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/fonts/outfit-latin-700-normal.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <!-- CookieConsent JS (self-hosted) -->
    <script defer src="/libs/cookieconsent/cookieconsent.min.js"></script>
  </head>

  <body style="background-color: #1a1a1a">
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>

    <script>
      /* Initialize CookieConsent */
      document.addEventListener("DOMContentLoaded", function () {
        if (window.cookieconsent && typeof window.cookieconsent.initialise === "function") {
          window.cookieconsent.initialise({
            palette: { popup: { background: "#000" }, button: { background: "#ffb81c" } },
            theme: "classic",
            position: "bottom",
            type: "opt-in",
            content: {
              message: "This site uses cookies to enhance your experience.",
              dismiss: "Allow",
              deny: "Decline",
              link: "Learn more",
              href: "/privacy"
            },
            onInitialise: function (status) {
              if (status === cookieconsent.status.allow) {
                window.dispatchEvent(new Event("consent-granted"));
              }
            },
            onStatusChange: function (status) {
              if (status === cookieconsent.status.allow) {
                window.dispatchEvent(new Event("consent-granted"));
              }
            }
          });
        } else {
          console.warn("CookieConsent script blocked or failed to load.");
        }
      });

      /* Load Analytics After Consent */
      window.addEventListener("consent-granted", () => {
        // Google Analytics
        const ga = document.createElement("script");
        ga.src = "https://www.googletagmanager.com/gtag/js?id=G-LNTDSW0VX0";
        ga.async = true;
        document.head.appendChild(ga);

        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag("js", new Date());
        gtag("config", "G-LNTDSW0VX0");

        // Clarity
        (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "u5k9hzt8ik");

      });
    </script>
  </body>
</html>
